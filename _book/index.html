<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>State Space Recipes in R</title>
  <meta name="description" content="This monograph is a collection of recipes for creating state-space models in R." />
  <meta name="generator" content="bookdown 0.16 and GitBook 2.6.7" />

  <meta property="og:title" content="State Space Recipes in R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This monograph is a collection of recipes for creating state-space models in R." />
  <meta name="github-repo" content="pteetor/StateSpaceRecipes" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="State Space Recipes in R" />
  
  <meta name="twitter:description" content="This monograph is a collection of recipes for creating state-space models in R." />
  

<meta name="author" content="Paul Teetor" />


<meta name="date" content="2019-12-23" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  

<link rel="next" href="randomWalk.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">State Space Recipes in R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#the-software"><i class="fa fa-check"></i><b>1.1</b> The Software</a><ul>
<li class="chapter" data-level="1.1.1" data-path="index.html"><a href="index.html#the-structts-function"><i class="fa fa-check"></i><b>1.1.1</b> The StructTS function</a></li>
<li class="chapter" data-level="1.1.2" data-path="index.html"><a href="index.html#the-dlm-package"><i class="fa fa-check"></i><b>1.1.2</b> The dlm package</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#the-examples"><i class="fa fa-check"></i><b>1.2</b> The Examples</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#online-materials"><i class="fa fa-check"></i><b>1.3</b> Online materials</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="randomWalk.html"><a href="randomWalk.html"><i class="fa fa-check"></i><b>2</b> Random Walk Model</a><ul>
<li class="chapter" data-level="2.1" data-path="randomWalk.html"><a href="randomWalk.html#fitting-a-random-walk-model"><i class="fa fa-check"></i><b>2.1</b> Fitting a Random Walk Model</a><ul>
<li class="chapter" data-level="" data-path="randomWalk.html"><a href="randomWalk.html#problem"><i class="fa fa-check"></i>Problem</a></li>
<li class="chapter" data-level="" data-path="randomWalk.html"><a href="randomWalk.html#solution"><i class="fa fa-check"></i>Solution</a></li>
<li class="chapter" data-level="" data-path="randomWalk.html"><a href="randomWalk.html#example"><i class="fa fa-check"></i>Example</a></li>
<li class="chapter" data-level="" data-path="randomWalk.html"><a href="randomWalk.html#discussion"><i class="fa fa-check"></i>Discussion</a></li>
<li class="chapter" data-level="" data-path="randomWalk.html"><a href="randomWalk.html#alt.-solution"><i class="fa fa-check"></i>Alt. Solution</a></li>
<li class="chapter" data-level="" data-path="randomWalk.html"><a href="randomWalk.html#alt.-example"><i class="fa fa-check"></i>Alt. Example</a></li>
<li class="chapter" data-level="" data-path="randomWalk.html"><a href="randomWalk.html#see-also"><i class="fa fa-check"></i>See Also</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="randomWalk.html"><a href="randomWalk.html#diagnosing-a-random-walk-model"><i class="fa fa-check"></i><b>2.2</b> Diagnosing a Random Walk Model</a><ul>
<li class="chapter" data-level="" data-path="randomWalk.html"><a href="randomWalk.html#problem-1"><i class="fa fa-check"></i>Problem</a></li>
<li class="chapter" data-level="" data-path="randomWalk.html"><a href="randomWalk.html#solution-1"><i class="fa fa-check"></i>Solution</a></li>
<li class="chapter" data-level="" data-path="randomWalk.html"><a href="randomWalk.html#example-1"><i class="fa fa-check"></i>Example</a></li>
<li class="chapter" data-level="" data-path="randomWalk.html"><a href="randomWalk.html#discussion-1"><i class="fa fa-check"></i>Discussion</a></li>
<li class="chapter" data-level="" data-path="randomWalk.html"><a href="randomWalk.html#alt.-solution-1"><i class="fa fa-check"></i>Alt. Solution</a></li>
<li class="chapter" data-level="" data-path="randomWalk.html"><a href="randomWalk.html#see-also-1"><i class="fa fa-check"></i>See Also</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="randomWalk.html"><a href="randomWalk.html#smoothing-with-a-random-walk-model"><i class="fa fa-check"></i><b>2.3</b> Smoothing With a Random Walk Model</a></li>
<li class="chapter" data-level="2.4" data-path="randomWalk.html"><a href="randomWalk.html#filtering-with-a-random-walk-model"><i class="fa fa-check"></i><b>2.4</b> Filtering With a Random Walk Model</a></li>
<li class="chapter" data-level="2.5" data-path="randomWalk.html"><a href="randomWalk.html#plotting-filtered-or-smoothed-results-with-a-random-walk-model"><i class="fa fa-check"></i><b>2.5</b> Plotting Filtered or Smoothed Results with a Random Walk Model</a></li>
<li class="chapter" data-level="2.6" data-path="randomWalk.html"><a href="randomWalk.html#forecasting-with-a-random-walk-model"><i class="fa fa-check"></i><b>2.6</b> Forecasting with a Random Walk Model</a></li>
<li class="chapter" data-level="2.7" data-path="randomWalk.html"><a href="randomWalk.html#plotting-forecasted-values-with-a-random-walk-model"><i class="fa fa-check"></i><b>2.7</b> Plotting Forecasted Values with a Random Walk Model</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="localLevel.html"><a href="localLevel.html"><i class="fa fa-check"></i><b>3</b> The Local Level Model</a><ul>
<li class="chapter" data-level="3.1" data-path="localLevel.html"><a href="localLevel.html#fitting-a-local-level-model"><i class="fa fa-check"></i><b>3.1</b> Fitting a Local Level Model</a><ul>
<li class="chapter" data-level="" data-path="localLevel.html"><a href="localLevel.html#problem-2"><i class="fa fa-check"></i>Problem</a></li>
<li class="chapter" data-level="" data-path="localLevel.html"><a href="localLevel.html#solution-2"><i class="fa fa-check"></i>Solution</a></li>
<li class="chapter" data-level="" data-path="localLevel.html"><a href="localLevel.html#example-2"><i class="fa fa-check"></i>Example</a></li>
<li class="chapter" data-level="" data-path="localLevel.html"><a href="localLevel.html#discussion-2"><i class="fa fa-check"></i>Discussion</a></li>
<li class="chapter" data-level="" data-path="localLevel.html"><a href="localLevel.html#alt.-solution-2"><i class="fa fa-check"></i>Alt. Solution</a></li>
<li class="chapter" data-level="" data-path="localLevel.html"><a href="localLevel.html#alt.-example-1"><i class="fa fa-check"></i>Alt. Example</a></li>
<li class="chapter" data-level="" data-path="localLevel.html"><a href="localLevel.html#see-also-2"><i class="fa fa-check"></i>See Also</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="localLevel.html"><a href="localLevel.html#smoothing-with-a-local-level-model"><i class="fa fa-check"></i><b>3.2</b> Smoothing With a Local Level Model</a><ul>
<li class="chapter" data-level="" data-path="localLevel.html"><a href="localLevel.html#problem-3"><i class="fa fa-check"></i>Problem</a></li>
<li class="chapter" data-level="" data-path="localLevel.html"><a href="localLevel.html#solution-3"><i class="fa fa-check"></i>Solution</a></li>
<li class="chapter" data-level="" data-path="localLevel.html"><a href="localLevel.html#example-3"><i class="fa fa-check"></i>Example</a></li>
<li class="chapter" data-level="" data-path="localLevel.html"><a href="localLevel.html#discussion-3"><i class="fa fa-check"></i>Discussion</a></li>
<li class="chapter" data-level="" data-path="localLevel.html"><a href="localLevel.html#alt.-solution-3"><i class="fa fa-check"></i>Alt. Solution</a></li>
<li class="chapter" data-level="" data-path="localLevel.html"><a href="localLevel.html#see-also-3"><i class="fa fa-check"></i>See Also</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="localLevel.html"><a href="localLevel.html#filtering-with-a-local-level-model"><i class="fa fa-check"></i><b>3.3</b> Filtering With a Local Level Model</a></li>
<li class="chapter" data-level="3.4" data-path="localLevel.html"><a href="localLevel.html#diagnosing-a-local-level-model"><i class="fa fa-check"></i><b>3.4</b> Diagnosing a Local Level Model</a></li>
<li class="chapter" data-level="3.5" data-path="localLevel.html"><a href="localLevel.html#plotting-a-local-level-model"><i class="fa fa-check"></i><b>3.5</b> Plotting a Local Level Model</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="localLinearTrend.html"><a href="localLinearTrend.html"><i class="fa fa-check"></i><b>4</b> The Local Linear Trend Model</a><ul>
<li class="chapter" data-level="4.1" data-path="localLinearTrend.html"><a href="localLinearTrend.html#fitting-a-local-linear-trend-model"><i class="fa fa-check"></i><b>4.1</b> Fitting a Local Linear Trend Model</a><ul>
<li class="chapter" data-level="" data-path="localLinearTrend.html"><a href="localLinearTrend.html#problem-4"><i class="fa fa-check"></i>Problem</a></li>
<li class="chapter" data-level="" data-path="localLinearTrend.html"><a href="localLinearTrend.html#solution-4"><i class="fa fa-check"></i>Solution</a></li>
<li class="chapter" data-level="" data-path="localLinearTrend.html"><a href="localLinearTrend.html#example-4"><i class="fa fa-check"></i>Example</a></li>
<li class="chapter" data-level="" data-path="localLinearTrend.html"><a href="localLinearTrend.html#discussion-4"><i class="fa fa-check"></i>Discussion</a></li>
<li class="chapter" data-level="" data-path="localLinearTrend.html"><a href="localLinearTrend.html#alt.-solution-4"><i class="fa fa-check"></i>Alt. Solution</a></li>
<li class="chapter" data-level="" data-path="localLinearTrend.html"><a href="localLinearTrend.html#alt.-example-2"><i class="fa fa-check"></i>Alt. Example</a></li>
<li class="chapter" data-level="" data-path="localLinearTrend.html"><a href="localLinearTrend.html#see-also-4"><i class="fa fa-check"></i>See Also</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="localLinearTrend.html"><a href="localLinearTrend.html#diagnoseLocalLinearTrend"><i class="fa fa-check"></i><b>4.2</b> Diagnosing a Local Linear Trend Model</a><ul>
<li class="chapter" data-level="" data-path="localLinearTrend.html"><a href="localLinearTrend.html#problem-5"><i class="fa fa-check"></i>Problem</a></li>
<li class="chapter" data-level="" data-path="localLinearTrend.html"><a href="localLinearTrend.html#solution-5"><i class="fa fa-check"></i>Solution</a></li>
<li class="chapter" data-level="" data-path="localLinearTrend.html"><a href="localLinearTrend.html#example-5"><i class="fa fa-check"></i>Example</a></li>
<li class="chapter" data-level="" data-path="localLinearTrend.html"><a href="localLinearTrend.html#discussion-5"><i class="fa fa-check"></i>Discussion</a></li>
<li class="chapter" data-level="" data-path="localLinearTrend.html"><a href="localLinearTrend.html#alt.-solution-5"><i class="fa fa-check"></i>Alt. Solution</a></li>
<li class="chapter" data-level="" data-path="localLinearTrend.html"><a href="localLinearTrend.html#alt.-example-3"><i class="fa fa-check"></i>Alt. Example</a></li>
<li class="chapter" data-level="" data-path="localLinearTrend.html"><a href="localLinearTrend.html#see-also-5"><i class="fa fa-check"></i>See Also</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="localLinearTrend.html"><a href="localLinearTrend.html#smoothing-with-a-local-linear-trend-model"><i class="fa fa-check"></i><b>4.3</b> Smoothing With a Local Linear Trend Model</a><ul>
<li class="chapter" data-level="" data-path="localLinearTrend.html"><a href="localLinearTrend.html#problem-6"><i class="fa fa-check"></i>Problem</a></li>
<li class="chapter" data-level="" data-path="localLinearTrend.html"><a href="localLinearTrend.html#solution-6"><i class="fa fa-check"></i>Solution</a></li>
<li class="chapter" data-level="" data-path="localLinearTrend.html"><a href="localLinearTrend.html#example-6"><i class="fa fa-check"></i>Example</a></li>
<li class="chapter" data-level="" data-path="localLinearTrend.html"><a href="localLinearTrend.html#discussion-6"><i class="fa fa-check"></i>Discussion</a></li>
<li class="chapter" data-level="" data-path="localLinearTrend.html"><a href="localLinearTrend.html#alt.-solution-6"><i class="fa fa-check"></i>Alt. Solution</a></li>
<li class="chapter" data-level="" data-path="localLinearTrend.html"><a href="localLinearTrend.html#see-also-6"><i class="fa fa-check"></i>See Also</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="localLinearTrend.html"><a href="localLinearTrend.html#filtering-with-a-local-linear-trend-model"><i class="fa fa-check"></i><b>4.4</b> Filtering With a Local Linear Trend Model</a><ul>
<li class="chapter" data-level="" data-path="localLinearTrend.html"><a href="localLinearTrend.html#problem-7"><i class="fa fa-check"></i>Problem</a></li>
<li class="chapter" data-level="" data-path="localLinearTrend.html"><a href="localLinearTrend.html#solution-7"><i class="fa fa-check"></i>Solution</a></li>
<li class="chapter" data-level="" data-path="localLinearTrend.html"><a href="localLinearTrend.html#example-7"><i class="fa fa-check"></i>Example</a></li>
<li class="chapter" data-level="" data-path="localLinearTrend.html"><a href="localLinearTrend.html#discussion-7"><i class="fa fa-check"></i>Discussion</a></li>
<li class="chapter" data-level="" data-path="localLinearTrend.html"><a href="localLinearTrend.html#alt.-solution-7"><i class="fa fa-check"></i>Alt. Solution</a></li>
<li class="chapter" data-level="" data-path="localLinearTrend.html"><a href="localLinearTrend.html#alt.-example-4"><i class="fa fa-check"></i>Alt. Example</a></li>
<li class="chapter" data-level="" data-path="localLinearTrend.html"><a href="localLinearTrend.html#see-also-7"><i class="fa fa-check"></i>See Also</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="localLinearTrend.html"><a href="localLinearTrend.html#plotting-a-local-linear-trend-model"><i class="fa fa-check"></i><b>4.5</b> Plotting a Local Linear Trend Model</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="regressionFixed.html"><a href="regressionFixed.html"><i class="fa fa-check"></i><b>5</b> Regression Model, Fixed Coefficients</a><ul>
<li class="chapter" data-level="5.1" data-path="regressionFixed.html"><a href="regressionFixed.html#fitting-a-regression-model-fixed-coefficients"><i class="fa fa-check"></i><b>5.1</b> Fitting a Regression Model, Fixed Coefficients</a></li>
<li class="chapter" data-level="5.2" data-path="regressionFixed.html"><a href="regressionFixed.html#diagnoseRegressionFixed"><i class="fa fa-check"></i><b>5.2</b> Diagnosing a Regression Model, Fixed Coefficients</a><ul>
<li class="chapter" data-level="" data-path="regressionFixed.html"><a href="regressionFixed.html#problem-8"><i class="fa fa-check"></i>Problem</a></li>
<li class="chapter" data-level="" data-path="regressionFixed.html"><a href="regressionFixed.html#solution-8"><i class="fa fa-check"></i>Solution</a></li>
<li class="chapter" data-level="" data-path="regressionFixed.html"><a href="regressionFixed.html#example-8"><i class="fa fa-check"></i>Example</a></li>
<li class="chapter" data-level="" data-path="regressionFixed.html"><a href="regressionFixed.html#discussion-8"><i class="fa fa-check"></i>Discussion</a></li>
<li class="chapter" data-level="" data-path="regressionFixed.html"><a href="regressionFixed.html#see-also-8"><i class="fa fa-check"></i>See Also</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="regressionFixed.html"><a href="regressionFixed.html#smoothRegressionFixed"><i class="fa fa-check"></i><b>5.3</b> Smoothing With a Regression Model, Fixed Coefficients</a><ul>
<li class="chapter" data-level="" data-path="regressionFixed.html"><a href="regressionFixed.html#problem-9"><i class="fa fa-check"></i>Problem</a></li>
<li class="chapter" data-level="" data-path="regressionFixed.html"><a href="regressionFixed.html#solution-9"><i class="fa fa-check"></i>Solution</a></li>
<li class="chapter" data-level="" data-path="regressionFixed.html"><a href="regressionFixed.html#example-9"><i class="fa fa-check"></i>Example</a></li>
<li class="chapter" data-level="" data-path="regressionFixed.html"><a href="regressionFixed.html#discussion-9"><i class="fa fa-check"></i>Discussion</a></li>
<li class="chapter" data-level="" data-path="regressionFixed.html"><a href="regressionFixed.html#see-also-9"><i class="fa fa-check"></i>See Also</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="regressionFixed.html"><a href="regressionFixed.html#filtering-with-a-regression-model-fixed-coefficients"><i class="fa fa-check"></i><b>5.4</b> Filtering With a Regression Model, Fixed Coefficients</a></li>
<li class="chapter" data-level="5.5" data-path="regressionFixed.html"><a href="regressionFixed.html#plotting-a-regression-model-fixed-coefficients"><i class="fa fa-check"></i><b>5.5</b> Plotting a Regression Model, Fixed Coefficients</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="regressionVarying.html"><a href="regressionVarying.html"><i class="fa fa-check"></i><b>6</b> Regression Model, Time-Varying Coefficients</a><ul>
<li class="chapter" data-level="6.1" data-path="regressionVarying.html"><a href="regressionVarying.html#fitting-a-regression-model-time-varying-coefficients"><i class="fa fa-check"></i><b>6.1</b> Fitting a Regression Model, Time-Varying Coefficients</a></li>
<li class="chapter" data-level="6.2" data-path="regressionVarying.html"><a href="regressionVarying.html#smoothing-with-a-regression-model-time-varying-coefficients"><i class="fa fa-check"></i><b>6.2</b> Smoothing With a Regression Model, Time-Varying Coefficients</a></li>
<li class="chapter" data-level="6.3" data-path="regressionVarying.html"><a href="regressionVarying.html#filtering-with-a-regression-model-time-varying-coefficients"><i class="fa fa-check"></i><b>6.3</b> Filtering With a Regression Model, Time-Varying Coefficients</a></li>
<li class="chapter" data-level="6.4" data-path="regressionVarying.html"><a href="regressionVarying.html#diagnosing-a-regression-model-time-varying-coefficients"><i class="fa fa-check"></i><b>6.4</b> Diagnosing a Regression Model, Time-Varying Coefficients</a></li>
<li class="chapter" data-level="6.5" data-path="regressionVarying.html"><a href="regressionVarying.html#plotting-a-regression-model-time-varying-coefficients"><i class="fa fa-check"></i><b>6.5</b> Plotting a Regression Model, Time-Varying Coefficients</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="arma.html"><a href="arma.html"><i class="fa fa-check"></i><b>7</b> ARMA Models</a><ul>
<li class="chapter" data-level="7.1" data-path="arma.html"><a href="arma.html#fitting-an-arma-model"><i class="fa fa-check"></i><b>7.1</b> Fitting an ARMA Model</a></li>
<li class="chapter" data-level="7.2" data-path="arma.html"><a href="arma.html#diagnosing-an-arma-model"><i class="fa fa-check"></i><b>7.2</b> Diagnosing an ARMA Model</a></li>
<li class="chapter" data-level="7.3" data-path="arma.html"><a href="arma.html#smoothing-with-an-arma-model"><i class="fa fa-check"></i><b>7.3</b> Smoothing With an ARMA Model</a></li>
<li class="chapter" data-level="7.4" data-path="arma.html"><a href="arma.html#filtering-with-an-arma-model"><i class="fa fa-check"></i><b>7.4</b> Filtering With an ARMA Model</a></li>
<li class="chapter" data-level="7.5" data-path="arma.html"><a href="arma.html#plotting-filtered-or-smoothed-results-with-an-arma-model"><i class="fa fa-check"></i><b>7.5</b> Plotting Filtered or Smoothed Results with an ARMA Model</a></li>
<li class="chapter" data-level="7.6" data-path="arma.html"><a href="arma.html#forecasting-with-an-arma-model"><i class="fa fa-check"></i><b>7.6</b> Forecasting with an ARMA Model</a></li>
<li class="chapter" data-level="7.7" data-path="arma.html"><a href="arma.html#plotting-forecasted-values-with-an-arma-model"><i class="fa fa-check"></i><b>7.7</b> Plotting Forecasted Values with an ARMA Model</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="boostrapping.html"><a href="boostrapping.html"><i class="fa fa-check"></i><b>8</b> Boostrapping a State-Space Model</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="chapter" data-level="9" data-path="TEMPLATE.html"><a href="TEMPLATE.html"><i class="fa fa-check"></i><b>9</b> TEMPLATE CHAPTER</a><ul>
<li class="chapter" data-level="9.1" data-path="TEMPLATE.html"><a href="TEMPLATE.html#fitting-an-xxx-model"><i class="fa fa-check"></i><b>9.1</b> Fitting an XXX Model</a></li>
<li class="chapter" data-level="9.2" data-path="TEMPLATE.html"><a href="TEMPLATE.html#diagnosing-an-xxx-model"><i class="fa fa-check"></i><b>9.2</b> Diagnosing an XXX Model</a></li>
<li class="chapter" data-level="9.3" data-path="TEMPLATE.html"><a href="TEMPLATE.html#smoothing-with-an-xxx-model"><i class="fa fa-check"></i><b>9.3</b> Smoothing With an XXX Model</a></li>
<li class="chapter" data-level="9.4" data-path="TEMPLATE.html"><a href="TEMPLATE.html#filtering-with-an-xxx-model"><i class="fa fa-check"></i><b>9.4</b> Filtering With an XXX Model</a></li>
<li class="chapter" data-level="9.5" data-path="TEMPLATE.html"><a href="TEMPLATE.html#plotting-filtered-or-smoothed-results-with-an-xxx-model"><i class="fa fa-check"></i><b>9.5</b> Plotting Filtered or Smoothed Results with an XXX Model</a></li>
<li class="chapter" data-level="9.6" data-path="TEMPLATE.html"><a href="TEMPLATE.html#forecasting-with-an-xxx-model"><i class="fa fa-check"></i><b>9.6</b> Forecasting with an XXX Model</a></li>
<li class="chapter" data-level="9.7" data-path="TEMPLATE.html"><a href="TEMPLATE.html#plotting-forecasted-values-with-an-xxx-model"><i class="fa fa-check"></i><b>9.7</b> Plotting Forecasted Values with an XXX Model</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/pteetor/state-space-recipes" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">State Space Recipes in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="header">
<h1 class="title">State Space Recipes in R</h1>
<p class="author"><em>Paul Teetor</em></p>
<p class="date"><em>2019-12-23</em></p>
</div>
<div id="introduction" class="section level1">
<h1><span class="header-section-number">Chapter 1</span> Introduction</h1>
<p>This monograph is a collection of recipes for creating state-space models in R.
I like the power of state-space models,
and R has several excellent packages for building them.
Unfortunately, it’s not quite an “out of the box” technology.
Using any package involves numerous little details,
and unless I used the package very recently,
building a model requires pulling out the package documentation,
reading it all over again, and trying to remember how the parts fit together.
One day I got tired of that,
so I put together these recipes.</p>
<p>This is not a tutorial for state-space models.
For a general introduction to state-space modeling,
I recommend the book by Commandeur and Koopman<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>.</p>
<p>In these notes, I use the <code>StructTS</code> function
to create the simpler models,
and I use the <code>dlm</code> package
for more complicated models.
There isn’t room here to cover other R packages.
If you’re interested in a survey of state-space packaqes for R,
I recommend the excellent review by Tusell<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a>.</p>
<div id="the-software" class="section level2">
<h2><span class="header-section-number">1.1</span> The Software</h2>
<div id="the-structts-function" class="section level3">
<h3><span class="header-section-number">1.1.1</span> The StructTS function</h3>
<p>R includes a function, <code>StructTS</code>, which can quickly and easily estimate
the parameters of simple state-space models
such as the <em>local level</em> model or the <em>local linear trend</em> model.<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a></p>
<p><code>StructTS</code> is one function in a group of functions
which, together, provide many features of state-space modeling.</p>
<table>
<thead>
<tr class="header">
<th align="left">Function</th>
<th align="left">Purpose</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">StructTS</td>
<td align="left">Estimate parameters of a simple state-space model</td>
</tr>
<tr class="even">
<td align="left">tsdiag</td>
<td align="left">Plot diagnostics for state-space model</td>
</tr>
<tr class="odd">
<td align="left">KalmanLike</td>
<td align="left">Calculate parameters’ log-likelihood (Gaussian model)</td>
</tr>
<tr class="even">
<td align="left">KalmanRun</td>
<td align="left">Filter time series data</td>
</tr>
<tr class="odd">
<td align="left">tsSmooth</td>
<td align="left">Smooth time series data (calls KalmanSmooth)</td>
</tr>
<tr class="even">
<td align="left">KalmanForecast</td>
<td align="left">Forecast time series points from model</td>
</tr>
<tr class="odd">
<td align="left">makeARIMA</td>
<td align="left">Create state-space model equivalent to ARIMA model</td>
</tr>
</tbody>
</table>
</div>
<div id="the-dlm-package" class="section level3">
<h3><span class="header-section-number">1.1.2</span> The dlm package</h3>
<p>For the advanced recipes,
I use the <code>dlm</code> package originally created by Giovanni Petris.<a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a>
The package is very well documented,
and Petris has even written a book regarding state-space models in general
and the <code>dlm</code> package in particular.<a href="#fn5" class="footnote-ref" id="fnref5"><sup>5</sup></a>
There is also an overview written by Petris and Petrone<a href="#fn6" class="footnote-ref" id="fnref6"><sup>6</sup></a>
which discusses several R packages with an emphasis on the <code>dlm</code> package.</p>
<p>The package contains many useful functions.
This monograph uses these.</p>
<table>
<thead>
<tr class="header">
<th align="left">Function</th>
<th align="left">Purpose</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">dlmModPoly</td>
<td align="left">Construct polynomial model</td>
</tr>
<tr class="even">
<td align="left">dlmModReg</td>
<td align="left">Construct regression model</td>
</tr>
<tr class="odd">
<td align="left">dlmMLE</td>
<td align="left">Estimate maximum likelihood parameters of model</td>
</tr>
<tr class="even">
<td align="left">dlmFilter</td>
<td align="left">Filter a time series</td>
</tr>
<tr class="odd">
<td align="left">dlmSmooth</td>
<td align="left">Smooth a time series</td>
</tr>
<tr class="even">
<td align="left">dlmBSample</td>
<td align="left">Draw from the posterior distribution</td>
</tr>
</tbody>
</table>
<p>The package includes a very cool feature,
which is the ability to “add” models together into a compound model.
That feature is not illustrated here,
but I urge any serious user to study the feature.
It would let you, say, easily combine a regression model with an ARMA model
to create a better model your data.</p>
</div>
</div>
<div id="the-examples" class="section level2">
<h2><span class="header-section-number">1.2</span> The Examples</h2>
<p>Many recipes includes an example.
The examples are intended to be fully stand-alone,
meaning you can cut and paste them directly into R and watch them run.</p>
<p>All examples use some concrete dataset, typically the Nile River data included with R.
The recipes start by assigning the time series data to variable <span class="math inline">\(y\)</span>, like this.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1">y &lt;-<span class="st"> </span>datasets<span class="op">::</span>Nile</a></code></pre></div>
<p>The subsequent code is written in terms of <span class="math inline">\(y\)</span>, not a specific dataset.
My goal was to let you copy the recipe, substitute your data for the Nile River data,
and try the recipe for yourself.</p>
</div>
<div id="online-materials" class="section level2">
<h2><span class="header-section-number">1.3</span> Online materials</h2>
<p>R code examples are available on a
public Github repository.</p>
<blockquote>
<p><a href="https://github.com/pteetor/StateSpaceRecipes" class="uri">https://github.com/pteetor/StateSpaceRecipes</a></p>
</blockquote>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p>Commandeur and Koopman (2007). <em>An Introduction to State Space Time Series Analysis</em>, Oxford University Press (ISBN 978-0-19-922887-4)<a href="index.html#fnref1" class="footnote-back">↩</a></p></li>
<li id="fn2"><p>Tusell (2011). “Kalman Filtering in R”, <em>Journal of Statistical Software</em> (<a href="http://www.jstatsoft.org/v39/i02/paper" class="uri">http://www.jstatsoft.org/v39/i02/paper</a>)<a href="index.html#fnref2" class="footnote-back">↩</a></p></li>
<li id="fn3"><p>Ripley (2002). “Time Series in R 1.5.0”, <em>R News</em> (<a href="http://cran.r-project.org/doc/Rnews/Rnews_2002-2.pdf" class="uri">http://cran.r-project.org/doc/Rnews/Rnews_2002-2.pdf</a>)<a href="index.html#fnref3" class="footnote-back">↩</a></p></li>
<li id="fn4"><p>Petris (2010). “An R Package for Dynamic Linear Models”, <em>Journal of Statistical Software</em> (<a href="http://www.jstatsoft.org/v36/i12/paper" class="uri">http://www.jstatsoft.org/v36/i12/paper</a>)<a href="index.html#fnref4" class="footnote-back">↩</a></p></li>
<li id="fn5"><p>Petris, Petrone, and Campagnoli (2009). <em>Dynamic Linear Models with R</em>, Springer (ISBN 978-0-387-77237-0)<a href="index.html#fnref5" class="footnote-back">↩</a></p></li>
<li id="fn6"><p>Petris and Petrone (2011). “State Space Models in R”, <em>Journal of Statistical Software</em> (<a href="http://www.jstatsoft.org/v41/i04/paper" class="uri">http://www.jstatsoft.org/v41/i04/paper</a>)<a href="index.html#fnref6" class="footnote-back">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>

<a href="randomWalk.html" class="navigation navigation-next navigation-unique" aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["state-space-recipes.pdf", "state-space-recipes.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
